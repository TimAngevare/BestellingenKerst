{% extends 'main.html' %}

{% block content %}
    <div class="w3-container">
        <a href="{% url 'zoekApp:producten' %}"><img style="width: 3%; height: auto; text-align: right;" src="https://img.icons8.com/ios-filled/50/000000/circled-left-2.png"/></a>
    </div>
<div class="w3-container">
    <h2>Totaal producten: {{ totaal }}</h2>
</div>
<hr>
<div class="w3-container">
    <h2>Producten</h2>
    {% for product in resultaten %}
        {% with counter=forloop.counter %}
        <div class="w3-center w3-container w3-card-4 w3-margin">
            {% for key, value in product.items %}
                <div class="w3-container">
                        {% if key == "product"%}
                            <div class="w3-container w3-blue-gray w3-center w3-margin">
                                <form method="post" action="{% url 'zoekApp:producten' %}">
                                    {% csrf_token %}
                                    <button name= "voltooi-{{value}}" class="w3-button w3-green w3-margin w3-round-large" type="submit">Voltooi</button>
                                    <button name= "probleem-{{value}}" class="w3-button w3-red w3-margin w3-round-large">Probleem</button>
                                    <button name= "behandeling-{{value}}" class="w3-button w3-orange w3-margin w3-round-large">Neem in behandeling</button>
                                </form>
                                <h4><b>{{value}}</b></h4>
                            </div>
                        {% elif key == "conf" %}
                            <ul class="w3-ul w3-border">
                            {% for soort, aantal in value.items %}
                                <li><b>{{ soort }}</b>
                                    {% for gem, hoeveelheid in aantal.items %}
                                        {{ gem }} : {{ hoeveelheid }}
                                    {% endfor %}
                                </li>
                            {% endfor %}
                            </ul>
                        {% elif key == "bijz" %}
                            <script type="text/javascript">
                                function bijztoggle{{ counter }}() {
                                    var x = document.getElementById("bijz{{ counter }}");
                                    if (x.style.display === "none") {
                                        x.style.display = "block";
                                    } else {
                                        x.style.display = "none";
                                    }
                                }
                            </script>
                            <button onclick="bijztoggle{{ counter }}()" class="w3-button w3-margin w3-container w3-round-large w3-border w3-border-blue-gray">Toggle bijzonderheden<img src="https://img.icons8.com/material-sharp/24/000000/expand-arrow--v2.png" style="width: 24px; height: auto;"/></button>
                            <div id="bijz{{ counter }}" style="display: none;" class="w3-container">
                                <table class="w3-table-all w3-card-4 w3-margin">
                                <tr>
                                    <th>Bestel Nummer</th>
                                    <th>Opmerking</th>
                                </tr>
                                {% for bestelling in value %}
                                    {% for bestelnmr, opmerking in bestelling.items %}
                                        <tr>
                                            <td>{{ bestelnmr }}</td>
                                            <td>{{ opmerking }}</td>
                                        </tr>
                                    {% endfor %}
                                {% endfor %}
                                </table>
                            </div>
                        {% elif key == "detail" %}
                            <script type="text/javascript">
                                function detailtoggle{{ counter }}() {
                                    var x = document.getElementById("detail{{ counter }}");
                                    if (x.style.display === "none") {
                                        x.style.display = "block";
                                    } else {
                                        x.style.display = "none";
                                    }
                                }
                            </script>
                            <button onclick="detailtoggle{{ counter }}()" class="w3-button w3-margin w3-container w3-round-large w3-border w3-border-blue-gray">Toggle detail <img src="https://img.icons8.com/material-sharp/24/000000/expand-arrow--v2.png" style="width: 24px; height: auto;"/></button>
                            <div id="detail{{ counter }}" style="display: none;" class="w3-container">
                                <table class="w3-table-all w3-card-4 w3-margin">
                                <tr>
                                    <th>Bestel Nummer</th>
                                    <th>Aantal</th>
                                </tr>
                                    {% for bestelnmr, opmerking in value.items %}
                                        <tr>
                                            <td>{{ bestelnmr }}</td>
                                            <td>{{ opmerking }}</td>
                                        </tr>
                                    {% endfor %}
                                </table>
                            </div>
                        {% elif key != "_id"%}
                            <p><b>{{ key }}</b> : {{ value }}</p>
                        {% endif %}
                </div>
            {% endfor %}
        </div>
        {% endwith %}
    {% endfor %}
</div>

{% endblock content %}